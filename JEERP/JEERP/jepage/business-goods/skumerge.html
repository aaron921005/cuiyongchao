<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>搜索页</title>
    <link href="../../assets/css/bs3/dpl.css" rel="stylesheet">
    <link href="../../assets/css/bs3/bui.css" rel="stylesheet">
    <style type="text/css">
    * {
        margin: 0;
        padding: 0;
    }

    ol,
    ul {
        list-style: none;
    }

    blockquote,
    q {
        quotes: none;
    }

    a {
        text-decoration: none;
        color: #2d2f30;
        -webkit-transition: all .3s linear;
        -moz-transition: all .3s linear;
        -o-transition: all .3s linear;
        -ms-transition: all .3s linear;
        transition: all .3s linear;
    }

    a:focus {
        outline: none;
    }

    .content {
        margin: auto;
        width: 1200px;
    }

    .sx_updown {
        width: 100%;
        background: #fff;
        overflow: hidden;
        z-index: 9999;
        left: 0;
        top: 38px;
        text-align: left;
    }

    .updown_box {
        /*float: left;*/
        min-height: 60px;
        width: 100%;
        border-left: 0px solid #f2f2f2;
        padding: 0 30px;
        -webkit-box-sizing: content-box;
        -moz-box-sizing: content-box;
        box-sizing: content-box;
    }

    .updown_box h3 {
        font-size: 16px;
        margin-bottom: 18px;
        padding-left: 10px;
    }

    .updown_box ul li {
        float: left;
        margin: 0 10px 10px 10px;
    }

    .updown_box ul li a {
        display: block;
        font-size: 14px;
        padding: 6px 8px;
        line-height: 18px;
    }

    .updown_box ul li.selected a {
        background: #7ecbc8;
        color: #fff;
    }

    .w136 {
        width: 136px;
        border-left: 0;
        padding: 0;
    }

    .w290 {
        width: 290px;
    }

    .w160 {
        width: 160px;
        padding: 0 40px;
    }

    .sousuo {
        padding: 10px 0 36px 0;
        width: 100%;
    }

    .select-result {
        width: 900px;
        float: left;
    }

    .select-result ul li a {
        height: 30px;
        padding: 0 24px 0 10px;
        line-height: 30px;
        display: block;
        position: relative;
        float: left;
        margin: 0 10px 10px 0;
        color: #fff;
        font-size: 14px;
        background: url(../../assets/img/close1.png) 90% center no-repeat #7ecbc8;
    }
    </style>
</head>

<body>
    <div class="demo-content">
        <!-- 搜索页 ================================================== -->
        <div class="row">
            <div class="span24">
                <form id="searchForm" class="form-horizontal" tabindex="0" style="outline: none;">
                    <div class="row">
                        <div class="control-group span8">
                            <label class="control-label">平台：</label>
                            <div class="controls">
                                <input type="text" name="a" class="control-text">
                            </div>
                        </div>
                        <div class="control-group span8">
                            <label class="control-label">店铺：</label>
                            <div class="controls">
                                <input type="text" name="b" class="control-text">
                            </div>
                        </div>
                        <div class="control-group span8">
                            <label class="control-label">SKU：</label>
                            <div class="controls">
                                <input type="text" name="c" class="control-text">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="control-group span8">
                            <label class="control-label">状态：</label>
                            <div class="controls">
                                <input type="text" name="a" class="control-text">
                            </div>
                        </div>
                        <div class="form-actions span5">
                            <button id="btnSearch" type="submit" class="button button-primary">搜索</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!-- 此节点内部的内容会在弹出框内显示,默认隐藏此节点-->
        <div id="tongbu" class="hidden" style="display: none;">
            <form id="form" class="form-horizontal">
                <div class="sx_updown clearfix">
                    <div class="content">
                        <div class="updown_box" >
                            <h3>选择平台</h3>
                            <ul id="select1">
                                <li><a href="javascript:;">Wish</a></li>
                                <li><a href="javascript:;">Amazon</a></li>
                                <li><a href="javascript:;">AliExpress</a></li>
                                <li><a href="javascript:;">Wish</a></li>
                                <li><a href="javascript:;">Amazon</a></li>
                                <li><a href="javascript:;">AliExpress</a></li>
                            </ul>
                        </div><br>
                        <div class="updown_box" >
                            <h3>选择店铺</h3>
                            <ul id="select2">
                                <li date-type="1"><a href="javascript:;">店铺1</a></li>
                                <li date-type="2"><a href="javascript:;">店铺2</a></li>
                                <li date-type="3"><a href="javascript:;">店铺3</a></li>
                                <li date-type="4"><a href="javascript:;">店铺4</a></li>
                                <li date-type="5"><a href="javascript:;">店铺5</a></li>
                                <li date-type="6"><a href="javascript:;">店铺6</a></li>
                                <li date-type="7"><a href="javascript:;">店铺7</a></li>
                            </ul>
                        </div>
                    </div>
                </div><br><br><br>
                <div class="progress progress-striped">
                    <div class="bar bar-success" style="width: 30%;"></div>
                </div>
                <div class="sousuo clearfix">
                    <div class="select-result clearfix">
                        <ul>
                        </ul>
                    </div>
                </div>
            </form>
        </div>
        <!-- 此节点内部的内容会在弹出框内显示,默认隐藏此节点-->
        <div id="guanli" class="hidden" style="display: none;">
            <form id="form" class="form-horizontal">
                <div class="demo-content">
                    <div class="row">
                        <div class="offset1 span20 doc-content" style="    margin-left: 26px;">
                            <img style="width: 55px;height: 55px;    margin-top: 23px;" src="https://s.tbcdn.cn/g/fi/act/finder/img/test/1.jpg">
                            <table class="table" style="    display: initial;    margin-left: 13px;">
                                <tbody>
                                    <tr>
                                        <td>MIER 16 Can Large Insulated Lunch Bag</td>
                                    </tr>
                                    <tr>
                                        <td>SKU：SA10050087-White 配对的平台SKU</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="offset1 span20 doc-content" style="    margin-left: 26px;">
                            <table cellspacing="0" class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th colspan="6">
                                            <ul class="toolbar">
                                                <li>
                                                    <label class="checkbox">
                                                        <input type="checkbox"><a href="#">全选</a></label>
                                                </li>
                                                <li>
                                                    <button class="button button-primary">添加</button>
                                                </li>
                                                <li>
                                                    <button class="button button-danger">删除</button>
                                                </li>
                                                <li>
                                                    <button class="button button-info">上架</button>
                                                </li>
                                                <li>
                                                    <button class="button button-warning">下架</button>
                                                </li>
                                            </ul>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th width="15"></th>
                                        <th>序号</th>
                                        <th>平台SKU</th>
                                        <th>平台</th>
                                        <th>店铺</th>
                                        <th>状态</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <input type="checkbox">
                                        </td>
                                        <td>1</td>
                                        <td>NCDS02300200078(WISH)</td>
                                        <td>Amazon</td>
                                        <td>店铺1</td>
                                        <td>上架</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="checkbox">
                                        </td>
                                        <td>1</td>
                                        <td>NCDS02300200078(WISH)</td>
                                        <td>Amazon</td>
                                        <td>店铺1</td>
                                        <td>上架</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="checkbox">
                                        </td>
                                        <td>1</td>
                                        <td>NCDS02300200078(WISH)</td>
                                        <td>Amazon</td>
                                        <td>店铺1</td>
                                        <td>上架</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="checkbox">
                                        </td>
                                        <td>1</td>
                                        <td>NCDS02300200078(WISH)</td>
                                        <td>Amazon</td>
                                        <td>店铺1</td>
                                        <td>上架</td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="checkbox">
                                        </td>
                                        <td>1</td>
                                        <td>NCDS02300200078(WISH)</td>
                                        <td>Amazon</td>
                                        <td>店铺1</td>
                                        <td>上架</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div>
                               <!--  <div class="pagination pull-right">
                                    <ul>
                                        <li class="disabled"><a href="#">« 上一页</a></li>
                                        <li class="active"><a href="#">1</a></li>
                                        <li><a href="#">2</a></li>
                                        <li><a href="#">3</a></li>
                                        <li><a href="#">4</a></li>
                                        <li><a href="#">下一页 »</a></li>
                                    </ul>
                                </div> -->
                            </div>
                        </div>
                        <!-- script end -->
                    </div>
                </div>
            </form>
        </div>
        <div class="search-grid-container">
            <button id="btnxinjian" class="button button-primary">新建</button>
            <button id="btnshanchu" class="button button-primary">删除</button>
            <button id="btnzhankaiall" class="button button-primary">展开所有</button>
            <button id="btnzhedieall" class="button button-primary">折叠所有</button>
            <button id="btntongbu" class="button button-primary">同步在线商品</button>
            <div id="grid">
            </div>
        </div>
        <script src="../../assets/js/jquery-1.8.1.min.js"></script>
        <script src="../../assets/js/bui-min.js?t=201309041336"></script>
        <script type="text/javascript">
        var tongbu;
        var xiangqing;
        var guanli;

        $(function() {

        });
        BUI.use(['bui/overlay', 'bui/form'], function(Overlay, Form) {

            var form = new Form.HForm({
                srcNode: '#form'
            }).render();

            tongbu = new Overlay.Dialog({
                title: '同步在线商品',
                width: 600,
                height: 420,
                //配置DOM容器的编号
                contentId: 'tongbu',
                buttons: [{
                    text: '开始同步',
                    elCls: 'button',
                    handler: function() {
                        // this.close();
                    }
                }],
            });
            guanli = new Overlay.Dialog({
                title: 'SKU管理',
                width: 850,
                height: 520,
                //配置DOM容器的编号
                contentId: 'guanli',
                buttons: [{
                    text: '保存',
                    elCls: 'button',
                    handler: function() {
                        // this.close();
                    }
                }],
            });
            //展开点击
            $("#grid").on("click", ".zhankai", function() {
                $(this).parent().parent().parent().parent().find('td:eq(1) div span').click();

            });
            //详情点击
//          $("#grid").on("click", ".xiangqing", function() {
//              alert('跳页面');
//
//          });
            //管理点击
            $("#grid").on("click", ".guanli", function() {
                guanli.show();
            });
        });



        // //创建表单，表单中的日历，不需要单独初始化
        // var form = new BUI.Form.HForm({
        //     srcNode: '#searchForm'
        // }).render();

        // form.on('beforesubmit', function(ev) {
        //     //序列化成对象
        //     var obj = form.serializeToObject();
        //     obj.start = 0; //返回第一页
        //     store.load(obj);
        //     return false;
        // });




        BUI.use(['bui/grid', 'bui/data'], function(Grid, Data) {
            var Grid = BUI.Grid,
                Store = BUI.Data.Store,
                columns = [
                    { title: '产品图片', width: 30, sortable: false, dataIndex: 'a' },
                    { title: '产品名称', width: 150, sortable: true, dataIndex: 'b', selectable: true },
                    {
                        title: 'SKU',
                        width: 100,
                        sortable: false,
                        dataIndex: 'c',
                        selectable: true,
                        renderer: function(value, obj) {
                            return value + ':' + obj.d;
                        }
                    },
                    { title: 'SKU重量', width: 30, sortable: true, dataIndex: 'd', showTip: true },
                    {
                        title: '店铺SKU/平台-店铺名称',
                        width: 100,
                        sortable: true,
                        dataIndex: 'e',
                        renderer: function(value, obj) {
                            return value + '-' + '<span class="grid-command zhankai">展开[+]</span>';
                        }
                    },
                    { title: '状态', width: 30, sortable: true, dataIndex: 'f' },
                    {
                        title: '操作',
                        width: 30,
                        dataIndex: 'g',
                        renderer: function(value, obj) {

                            var c = '<a class="grid-command xiangqing" href="skumerge_detail.html">商品详情</a>';
                            c += '<span class="grid-command guanli">SKU管理</span>';
                            return c;
                        }
                    }
                ];

            // data = [{ a: '123', records: [{ a: '123' }, { b: '2334' }] }, { a: 'cdd', b: 'edd', records: [{ a: '123' }, { b: '2334' }] }, { a: '1333', c: 'eee', d: 2, records: [{ a: '123' }, { b: '2334' }] }];

            // 实例化 Grid.Plugins.Cascade 插件
            var cascade = new Grid.Plugins.Cascade({
                    renderer: function(record) {
                        return '<div class="inner-grid"></div>'; //生成简单表格的容器
                    }
                }),
                //简单表格的配置信息
                simpleGridConfig = {
                    autoRender: true, //自动生成
                    columns: BUI.cloneObject([
                        { title: '', width: 30, sortable: false, dataIndex: 'a' },
                        { title: '', width: 150, sortable: true, dataIndex: 'b', selectable: true },
                        {
                            title: '',
                            width: 100,
                            sortable: false,
                            dataIndex: 'c',
                            selectable: true
                        },
                        { title: '', width: 30, sortable: true, dataIndex: 'd', showTip: true },
                        {
                            title: '店铺SKU/平台-店铺名称',
                            width: 100,
                            sortable: true,
                            dataIndex: 'e',
                            renderer: function(value, obj) {
                                return value;
                            }
                        },
                        { title: '', width: 30, sortable: true, dataIndex: 'f' },
                        {
                            title: '',
                            width: 30,
                            dataIndex: 'g'
                        }
                    ]) //这里为了简单起见，复制了配置信息，应用中需要自己配置
                };

            var store = new Store({
                    url: '../../data/skumerge.json',
                    autoLoad: true
                }),
                grid = new Grid.Grid({
                    render: '#grid',
                    columns: columns,
                    loadMask: true,
                    forceFit: true,
                    store: store,
                    plugins: [cascade, Grid.Plugins.CheckSelection, Grid.Plugins.AutoFit] // Grid.Plugins.Cascade 插件
                });

            grid.render();

            cascade.on('expand', function(ev) {
                var data = ev.record,
                    row = ev.row,
                    sgrid = $(row).data('sub-grid');
                if (!sgrid) {
                    var container = $(row).find('.inner-grid'),
                        gridConfig = BUI.cloneObject(simpleGridConfig);
                    gridConfig.render = container;

                    sgrid = new Grid.SimpleGrid(gridConfig);
                    sgrid.showData(data.records);
                    $(row).data('sub-grid', sgrid);
                }
            });

            cascade.on('removed', function(ev) {
                var data = ev.record,
                    row = ev.row,
                    sgrid = $(row).data('sub-grid');
                if (sgrid) {
                    sgrid.destroy();
                }
            });
            //新建

            $('#btnxinjian').on('click', function() {

            });
            //删除

            $('#btnshanchu').on('click', function() {

            });
            //展开

            $('#btnzhankaiall').on('click', function() {
                cascade.expandAll();

            });
            //折叠

            $('#btnzhedieall').on('click', function() {
                cascade.collapseAll();

            });
            //同步

            $('#btntongbu').on('click', function() {
                tongbu.show();

            });

        });


        $("#select1 li").click(function() {
            $(this).addClass("selected").siblings().removeClass("selected");
            var copyThisA = $(this).clone();
            //console.log(copyThisA);
            if ($("#selectA").length > 0) {
                $("#selectA a").html($(this).text());
            } else {
                $(".select-result ul").append(copyThisA.attr("id", "selectA"));
            }
        });
        $("#select2 li").click(function() {
            var type = $(this).attr("date-type");
            var copyThisB = $(this).clone();
            if ($(this).hasClass("selected")) {
                $(".select-result li[date-type='" + type + "']").fadeToggle();
            } else {
                $(".select-result ul").append(copyThisB);
            };
            $(this).toggleClass("selected");

        });
        $("#select3 li").click(function() {
            $(this).addClass("selected").siblings().removeClass("selected");
            var copyThisC = $(this).clone();
            if ($("#selectC").length > 0) {
                $("#selectC a").html($(this).text());
            } else {
                $(".select-result ul").append(copyThisC.attr("id", "selectC"));
            }
        });
        $("#selectA").live("click", function() {
            $(this).remove();
            $("#select1 li").removeClass("selected");
        });
        $(".select-result ul").delegate("li", "click", function() {
            var type = $(this).attr("date-type");
            $(this).fadeOut();
            $("#select2 li[date-type='" + type + "']").removeClass("selected");
        });
        $("#selectC").live("click", function() {
            $(this).remove();
            $("#select3 li").removeClass("selected");
        });
        </script>
        <!-- script end -->
</body>

</html>